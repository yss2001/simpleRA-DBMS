LOAD EMPLOYEE
Q1_TEMP <- PROJECT Ssn, Salary FROM EMPLOYEE
Q1 <- SELECT Salary >= 30000 FROM Q1_TEMP

EMP <- PROJECT Ssn, Super_ssn, Bdate FROM EMPLOYEE
CROSS_Q2 <- CROSS EMP EMP

Q2_TEMPA <- SELECT EMP1_Super_ssn == EMP2_Ssn FROM CROSS_Q2
Q2_TEMPB <- SELECT EMP1_Bdate == EMP2_Bdate FROM Q2_TEMPA
Q2 <- PROJECT EMP1_Ssn,EMP1_Super_ssn,EMP1_Bdate FROM Q2_TEMPB
RENAME EMP1_Ssn TO Ssn FROM Q2
RENAME EMP1_Super_ssn TO Super_ssn FROM Q2
RENAME EMP1_Bdate TO Bdate FROM Q2

T_EMP <- PROJECT Ssn, Sex FROM EMPLOYEE
LOAD WORKS_ON
T_WO <- PROJECT Essn, Pno FROM WORKS_ON
CROSS_Q3 <- CROSS T_EMP, T_WO
Q3_TEMP <- SELECT Ssn == Essn FROM CROSS_Q3
M_TEMP <- SELECT Sex == 0 FROM Q3_TEMP
F_TEMP <- SELECT Sex == 1 FROM Q3_TEMP
CROSS_MF <- CROSS M_TEMP F_TEMP
Q3_PTEMP <- SELECT M_TEMP_Pno == F_TEMP_Pno FROM CROSS_MF
Q3 <- PROJECT M_TEMP_Pno FROM Q3_PTEMP
RENAME M_TEMP_Pno TO Pno FROM Q3

Q4_TEMPA <- PROJECT Ssn, Super_ssn FROM EMPLOYEE
CROSS_Q4 <- CROSS Q4_TEMPA WORKS_ON
Q4_EMP <- SELECT Ssn == Essn FROM CROSS_Q4
Q4_FILT <- PROJECT Ssn, Super_ssn, Pno FROM Q4_EMP
Q4_EMPCROSS <- CROSS Q4_FILT Q4_FILT
Q4_TEMPB <- SELECT Q4_FILT1_Super_ssn == Q4_FILT2_Ssn FROM Q4_EMPCROSS
Q4_TEMPC <- SELECT Q4_FILT1_Pno == Q4_FILT2_Pno FROM Q4_TEMPB
Q4 <- PROJECT Q4_FILT1_Ssn, Q4_FILT1_Super_ssn, Q4_FILT1_Pno FROM Q4_TEMPC
RENAME Q4_FILT1_Ssn TO Ssn FROM Q4
RENAME Q4_FILT1_Super_ssn TO Super_ssn FROM Q4
RENAME Q4_FILT1_Pno TO Pno FROM Q4

LOAD PROJECT
Q5_TEMPA <- SELECT Dnum <= 5 FROM PROJECT
Q5_TEMPB <- SELECT Dnum >= 1 FROM Q5_TEMPA
Q5_TEMPC <- SELECT Dnum != 4 FROM Q5_TEMPB
Q5_TEMPD <- SELECT Dnum != 3 FROM Q5_TEMPC
Q5 <- SELECT Dnum != 2 FROM Q5_TEMPD

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
EXPORT Q5
QUIT
